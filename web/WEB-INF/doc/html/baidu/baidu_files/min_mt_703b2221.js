F._setMod("msg");F._fileMap({"/js/min_mt_5bc1f452.js":["config","start/mt_start","log/mt_all","msg/index_nav_msg","msg/const","msg/data_server","msg/data_adapter"],"/js/mt_ext_ff51aeb3.js":["msg/index_nav_msg_extend","msg/msg_builder","msg/bind","msg/bind_window"],"/js/min_notice_8a9d0796.js":["start/notice_start","mt/mt_show","mt/mt_msg_constructor"],"/css/min_notice_24caa1da.css":["index_msg.css","skin.css","skin_opacity.css"],"/js/notice_ext_dbefae2d.js":["mt/mt_ext","mt/mt_msg_item","mt/mt_msg_operate"],"/css/mt_min_b0183f3f.css":["index_bind_msg.css"],"/js/setting_msg_b8b8447a.js":["msg/const","msg/bind","msg/bind_window"]});F._defService("msg",{noticeStart:"start/notice_start",start:"start/mt_start",idxNavMsg:"msg/index_nav_msg",dataServer:"msg/data_server",snsBind:"msg/bind"});F._firstScreenCSS=F._firstScreenCSS||[];F._firstScreenCSS.push("/css/mt_min_b0183f3f.css");F.module("msg:start/mt_start",function(c,b,a){var d=a.base;b.run=function(){a.use("log/mt_all",function(e){e.init()})}});F.module("msg:log/mt_all",function(c,b,a){b.init=function(){F.addLog("msg:msg",{guidePopupShow:"0100700000",guidePopupClick:"0100700001",msgNavClick:"0100200001",tipClick:"0100100001"});F.addLog("msg:mt",{msgShow:"1700000000",msgItemClick:"1700100001",msgItemDelClick:"1700400001",msgBtnClick:"1700500001",msgContentShow:"1701000000"})}});F.module("msg:msg/index_nav_msg",function(d,h,o){var b=d("msg/const"),e=d("msg/data_server"),g=o.base;var c={MARK_MSG_NUM:'<span class="#{classname}"><span>#{number}</span></span>',MARK_MSG_NEW:'<span class="#{classname}"><span>1</span></span>',MARK_BIND:'<span class="bm-mark bm-bind"><a class="bm-bind-link" target="_blank" href="#" onclick="return false">&nbsp;</a></span>',MARK_APP_BIND:'<span class="bm-mark bm-bind"><a class="bm-bind-link" target="_blank" href="#{bindUrl}" onclick="return true;">&nbsp;</a></span>',MARK_EMAIL:'<span class="bm-mark bm-email-pwd"></span>'};var a=function(s,u){var r=e.getData(s);var q,t,p;if(!r){u()}else{switch(r.dataType){case b.DATA_TYPE.BIND:q=c.MARK_BIND;t="afterEnd";break;case b.DATA_TYPE.MSG:if(b.util.needShowMsg(r)||b.util.needShowNew(r)){t="beforeEnd";q=g.formatString(c["MARK_MSG_"+r.markType.toUpperCase()],{classname:"bm-mark bm-hasmsg",number:r.number>99?"99+":r.number})}else{t="beforeEnd"}break;case b.DATA_TYPE.EMAIL:q=c.MARK_EMAIL;t="beforeEnd";break}}if(t){p=b.util.getNavData(r)}u(t,q,p)};var f=function(q,r){var p=e.getData(q);if(!p){r()}else{o.use("msg/index_nav_msg_extend",function(t){var s=t.getNavConfig(p);r(s)})}};var j=function(){F.getService("nav","addProxy",function(p){if(!p.isEmptyNavUser){e.loadData()}})};var n=function(){j();o.listen("nav:nav","addNavItem",function(p){setTimeout(function(){i(p.id)},1000)});o.listen("msg/bind","bindEnd",function(p){i(p.navId)})};var i=function(p){F.getService("nav","nav",function(r){var q=r.ndc.getNavById(p);if(!q){return}e.updateData(p,q.url)})};var k=function(p){var q=e.getData(p);F.getService("nav","nav",function(r){navLog=r.ndc.getNavParams(p)||{};if(!q){o.warn("msgSawError","no msg with id"+p);return}else{o.use("msg/index_nav_msg_extend",function(s){s.msgSaw(q)})}o.fire("tipClick",g.extend({tipType:b.MSG.tipType.VIDEO,webid:q.webId,videoUrl:q.msgDetail&&q.msgDetail.curObjUrl,finish:q.msgDetail&&q.msgDetail.finish},navLog))})};var m=function(q){var p=e.getData(q);F.getService("nav","nav",function(r){navLog=r.ndc.getNavParams(q)||{};if(!p){o.warn("msgSawError","no msg with id"+q);return}o.use("msg/bind",function(s){s.emailRebind(p,{navId:q})});o.fire("tipClick",g.extend({tipType:b.MSG.tipType.EMAIL,webid:p.webId,bindStatus:msg.bindStatus,bindType:msg.bindType},navLog))})};var l=function(q,p){var r=e.getData(q);window.urSendClick=window.urSendClick||function(){};window.urSendClick({pid:"super",mod:"msg",type:"msgtip",method:"click",jump:"1",webid:r.webId});F.getService("nav","nav",function(s){navLog=s.ndc.getNavParams(q)||{};if(!r){o.warn("msgSawError","no msg with id"+q);return}o.fire("tipClick",g.extend({tipType:b.MSG.tipType.LIST,webid:r.webId,bindStatus:r.bindStatus,bindType:r.bindType},navLog))})};h.getMarkConfig=a;h.getMsgConfig=f;h.msgSaw=k;h.emailRebind=m;h.msgDetailClick=l;h.init=n;h.loadData=j});F.module("msg:msg/const",function(a,c,j){var b=j.domain;var h="frombaidu=1";var e={hadBind:{YES:"1",NO:"0"},bindType:{IN:"2",OUT:"1",INNER:"3",EMAIL:"4",RELOGIN:"5"},outSubBindType:{OLD:"0",NEW:"1",APP:"-2"},receive:{YES:"0",NO:"1"},canReceive:{YES:"2",NO:"1"},msgsettingConnect:{INNER:"1",CAN:"2",CANNOT:"3"},showPopup:{YES:"2",NO:"4"}};var i={video:{finish:{YES:1,NO:0},saw:{YES:1,NO:0}},markType:{NUM:"num",NEW:"new",EXCA:"exca"},tipType:{LIST:"list",VIDEO:"video",EMAIL:"email",NOVEL:"novel"}};var g={BIND:"bind",MSG:"msg",EMAIL:"email",SETTING:"setting"};var f={dataSetting:b.baseuri+"/msg/data/setting",dataPersonalSetting:b.baseuri+"/msg/data/personalsetting",dataMsg:b.baseuri+"/nplus/data/msg",showEmail:b.baseuri+"/msg/show/email",showSetting_msg:b.baseuri+"/page/show/setting?tab=msg",submitEmailbind:b.baseuri+"/msg/submit/emailbind",submitEmailunbind:b.baseuri+"/msg/submit/emailunbind",submitReceive:b.baseuri+"/msg/submit/receive",submitBind:b.baseuri+"/msg/submit/bind",submitUnbind:b.baseuri+"/msg/submit/unbind",submitMsgsaw:b.baseuri+"/msg/submit/msgsaw",submitPoptip:b.baseuri+"/msg/submit/poptip",openBind:b.baseuri+"/msg/open/bind",openRejump:b.baseuri+"/msg/open/rejump",passStartlogin:"http://passport.baidu.com/phoenix/account/startlogin"};var d={getNavData:function(k){return{navId:k.navId,name:k.fullName,url:k.url,icon:k.icon,reBind:k.reBind}},addFromBaidu:function(k){if(k.indexOf(h)>0){return k}var m=k.split("#"),l=m[0];l=l+(l.indexOf("?")>-1?"&":"?")+h;m[0]=l;return m.join("#")},windowOpen:function(m,l,o,n){var k=null;try{k=window.open(m,l,o,n);if(k==null){arg[0]="";k=window.open.apply("",l,o,n);k.location.href=m}}catch(p){j.fail("windowOpenFailed","window.open失败",{userAgent:navigator.userAgent})}if(!k){j.fail("windowOpenFailed","window.open为空",{userAgent:navigator.userAgent})}return k},needShowMsg:function(k){switch(k.markType){case i.markType.NUM:return k.number&&k.receive==e.receive.YES;break;case i.markType.NEW:return d.needShowNew(k);break;case i.markType.EXCA:return true;break}},needShowNew:function(k){return k.msgDetail.finish==i.video.finish.NO&&k.msgDetail.saw==i.video.saw.NO},isNewWeb:function(k){return k.bindType==e.bindType.OUT&&k.subBindType==e.outSubBindType.NEW},isAppWeb:function(k){return k.bindType==e.bindType.OUT&&k.subBindType==e.outSubBindType.APP}};c.util=d;c.BIND=e;c.URLS=f;c.MSG=i;c.DATA_TYPE=g});F.module("msg:msg/data_server",function(c,f,n){var b=c("msg/const"),j=b.URLS,h=c("msg/data_adapter");var e=n.base;var d={};var i=function(){e.ajax.get(j.dataMsg+"?asyn=1&t="+new Date().getTime(),function(r){var q=[];var r=h.convert(r);for(var s in r){q.push(s)}d=r;n.fire("dataUpdated",{relatedNavs:q});var t={"2":true,"6":true,"311638":true};for(var o in r){var p=r[o];if(p&&p.bindStatus=="binded"&&t[p.webId]){window.urMsgData=window.urMsgData||[];window.urMsgData.push({pid:"super",mod:"msg",type:"msgtip",webid:p.webId})}}if(window.urMsgData&&window.urMsgData.length>0&&window.urSendStaticData){for(var o in urMsgData){urSendStaticData(urMsgData[o],((+o)||0)*300)}}})};var k=function(p,o){e.ajax.get(j.dataMsg+"?asyn=1&shortcutid="+p+"&shortcuturl="+o+"&t="+Math.random(),function(q){if(!q.shortcutInfo){return}q=h.convertUpdatedData(q);m(q)})};var g=function(o){return d[o]};var m=function(o){d[o.navId]=o;n.fire("dataUpdated",{relatedNavs:[o.navId]})};var a=function(u,p){var t=d[u];if(!t){return}var r=p.attr.split("."),q=t;for(var s=0,o=r.length;s<o-1;s++){q=q[r[s]]}q[r[s]]=p.value;if(p.isEffectUI){n.fire("dataUpdated",{relatedNavs:[u]})}};var l=function(){return d};f.loadData=i;f.updateData=k;f.getData=g;f.setData=m;f.getDataCache=l;f.setDataAttr=a});F.module("msg:msg/data_adapter",function(c,e,l){var b=c("msg/const"),a=b.BIND,g=b.MSG;var d=l.base;var j=function(m){return m};var k=function(m){m.msgId=m.msgDetail.msgId||"";m.markType=m.resType=="1"?g.markType.NEW:g.markType.NUM;m.tipType=m.resType=="1"?(m.msgDetail.videoType==4?g.tipType.NOVEL:g.tipType.VIDEO):g.tipType.LIST;m.isResource=m.resType=="1";return m};var f=function(m){m.bindType=a.bindType.EMAIL;m.subBindType=m.webId;m.markType=g.markType.EXCA;m.tipType=g.markType.EMAIL;return m};var i=function(n){var m={};d.forEach(n.shortcutUnbind,function(o){o=j(o);o.bindStatus="unbind";m[o.navId]=o});d.forEach(n.userDetailMsg,function(o){o=k(o);o.bindStatus="binded";m[o.navId]=o});if(n.emailRebind){d.forEach(n.emailRebind,function(o){o=f(o);o.bindStatus="rebind";m[o.navId]=o})}return m};var h=function(o){var n=o.shortcutInfo,m=null;switch(n.dataType){case"msg":m=k(n);break;case"bind":m=j(n);break}return m};e.convert=i;e.convertUpdatedData=h});